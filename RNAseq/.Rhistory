knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
data <- read.table("variants_PLI.table",header = T, sep = "\t")
samples <- c("Ce1_1.AD", "Ce1_2.AD", "Ce3_1.AD", "Ce3_2.AD", "Fr1_1.AD", "Fr1_2.AD", "Fr3_1.AD", "Fr3_2.AD", "G0_1.AD", "G0_2.AD")
results <- list()
for (sample in samples) {
SNP_number <- 0
for (variant in data[[sample]]) {
i = dim(str_split(variant, ",", simplify = TRUE))[2]
pass = "False"
while (pass == "False") {
if ((str_split(variant, ",", simplify = TRUE)[i]) > 0){
SNP_number = SNP_number + 1
pass = "True"
}
i = i - 1
if (i == 1) {
pass = "True"
}
}
}
results$samples[[sample]] <- SNP_number
}
library(grid)
library(gridBase)
variant_barplot <- barplot(unlist(results), names.arg="", col=c("palegreen4","palegreen4","palegreen2", "palegreen2", "royalblue3", "royalblue3",
"royalblue1", "royalblue1", "orange2", "orange2"))
## Use grid to add the labels
vps <- baseViewports()
pushViewport(vps$inner, vps$figure, vps$plot)
grid.text(samples,
x = unit(variant_barplot, "native"), y=unit(-1, "lines"),
just="right", rot=50)
popViewport(3)
str_split(variant, ",", simplify = TRUE)
View(data)
data[[sample]]
knitr::opts_chunk$set(echo = TRUE)
samples <- c("Ce1_1.PL", "Ce1_2.PL", "Ce3_1.PL", "Ce3_2.PL", "Fr1_1.PL", "Fr1_2.PL", "Fr3_1.PL", "Fr3_2.PL", "G0_1.PL", "G0_2.PL")
for (sample in samples) {
HET_pos_number <- 0
for (variant in data[[sample]]) {
str_split(variant, ",", simplify = TRUE)
# if (dim(str_split(variant, ",", simplify = TRUE))[2] == 3) {
#   if ((str_split(variant, ",", simplify = TRUE)[2]) == 0 && (str_split(variant, ",", simplify = TRUE)[1]) != 0 ){
#     HET_pos_number = HET_pos_number + 1
#   }
# }
# else if (dim(str_split(variant, ",", simplify = TRUE))[2] == 6) {
#   if ((str_split(variant, ",", simplify = TRUE)[1]) != 0 && (str_split(variant, ",", simplify = TRUE)[3]) != 0 && (str_split(variant, ",", simplify = TRUE)[6]) != 0){
#     HET_pos_number = HET_pos_number + 1
#   }
# }
# else if (dim(str_split(variant, ",", simplify = TRUE))[2] == 10) {
#   if ((str_split(variant, ",", simplify = TRUE)[1]) != 0 && (str_split(variant, ",", simplify = TRUE)[3]) != 0 && (str_split(variant, ",", simplify = TRUE)[6]) != 0 && (str_split(variant, ",", simplify = TRUE)[10]) != 0){
#     HET_pos_number = HET_pos_number + 1
#   }
# }
# else if (dim(str_split(variant, ",", simplify = TRUE))[2] == 15) {
#   if ((str_split(variant, ",", simplify = TRUE)[1]) != 0 && (str_split(vr, ",", simplify = TRUE)[3]) != 0 && (str_split(variant, ",", simplify = TRUE)[6]) != 0 && (str_split(variant, ",", simplify = TRUE)[10]) != 0 && (str_split(variant, ",", simplify = TRUE)[15]) != 0){
#   HET_pos_number = HET_pos_number + 1
#   }
# }
# else if (dim(str_split(variant, ",", simplify = TRUE))[2] == 21) {
#   if ((str_split(variant, ",", simplify = TRUE)[1]) != 0 && (str_split(variant, ",", simplify = TRUE)[3]) != 0 && (str_split(variant, ",", simplify = TRUE)[6]) != 0 && (str_split(variant, ",", simplify = TRUE)[10]) != 0 && (str_split(variant, ",", simplify = TRUE)[15]) != 0 && (str_split(variant, ",", simplify = TRUE)[21]) != 0){
#     HET_pos_number = HET_pos_number + 1
#   }
# }
# else if (dim(str_split(variant, ",", simplify = TRUE))[2] == 28) {
#   if ((str_split(variant, ",", simplify = TRUE)[1]) != 0 && (str_split(variant, ",", simplify = TRUE)[3]) != 0 && (str_split(variant, ",", simplify = TRUE)[6]) != 0 && (str_split(variant, ",", simplify = TRUE)[10]) != 0 && (str_split(variant, ",", simplify = TRUE)[15]) != 0 && (str_split(variant, ",", simplify = TRUE)[21]) != 0 && (str_split(variant, ",", simplify = TRUE)[28]) != 0){
#     HET_pos_number = HET_pos_number + 1
}
}
library(tidyverse)
samples <- c("Ce1_1.PL", "Ce1_2.PL", "Ce3_1.PL", "Ce3_2.PL", "Fr1_1.PL", "Fr1_2.PL", "Fr3_1.PL", "Fr3_2.PL", "G0_1.PL", "G0_2.PL")
for (sample in samples) {
HET_pos_number <- 0
for (variant in data[[sample]]) {
str_split(variant, ",", simplify = TRUE)
# if (dim(str_split(variant, ",", simplify = TRUE))[2] == 3) {
#   if ((str_split(variant, ",", simplify = TRUE)[2]) == 0 && (str_split(variant, ",", simplify = TRUE)[1]) != 0 ){
#     HET_pos_number = HET_pos_number + 1
#   }
# }
# else if (dim(str_split(variant, ",", simplify = TRUE))[2] == 6) {
#   if ((str_split(variant, ",", simplify = TRUE)[1]) != 0 && (str_split(variant, ",", simplify = TRUE)[3]) != 0 && (str_split(variant, ",", simplify = TRUE)[6]) != 0){
#     HET_pos_number = HET_pos_number + 1
#   }
# }
# else if (dim(str_split(variant, ",", simplify = TRUE))[2] == 10) {
#   if ((str_split(variant, ",", simplify = TRUE)[1]) != 0 && (str_split(variant, ",", simplify = TRUE)[3]) != 0 && (str_split(variant, ",", simplify = TRUE)[6]) != 0 && (str_split(variant, ",", simplify = TRUE)[10]) != 0){
#     HET_pos_number = HET_pos_number + 1
#   }
# }
# else if (dim(str_split(variant, ",", simplify = TRUE))[2] == 15) {
#   if ((str_split(variant, ",", simplify = TRUE)[1]) != 0 && (str_split(vr, ",", simplify = TRUE)[3]) != 0 && (str_split(variant, ",", simplify = TRUE)[6]) != 0 && (str_split(variant, ",", simplify = TRUE)[10]) != 0 && (str_split(variant, ",", simplify = TRUE)[15]) != 0){
#   HET_pos_number = HET_pos_number + 1
#   }
# }
# else if (dim(str_split(variant, ",", simplify = TRUE))[2] == 21) {
#   if ((str_split(variant, ",", simplify = TRUE)[1]) != 0 && (str_split(variant, ",", simplify = TRUE)[3]) != 0 && (str_split(variant, ",", simplify = TRUE)[6]) != 0 && (str_split(variant, ",", simplify = TRUE)[10]) != 0 && (str_split(variant, ",", simplify = TRUE)[15]) != 0 && (str_split(variant, ",", simplify = TRUE)[21]) != 0){
#     HET_pos_number = HET_pos_number + 1
#   }
# }
# else if (dim(str_split(variant, ",", simplify = TRUE))[2] == 28) {
#   if ((str_split(variant, ",", simplify = TRUE)[1]) != 0 && (str_split(variant, ",", simplify = TRUE)[3]) != 0 && (str_split(variant, ",", simplify = TRUE)[6]) != 0 && (str_split(variant, ",", simplify = TRUE)[10]) != 0 && (str_split(variant, ",", simplify = TRUE)[15]) != 0 && (str_split(variant, ",", simplify = TRUE)[21]) != 0 && (str_split(variant, ",", simplify = TRUE)[28]) != 0){
#     HET_pos_number = HET_pos_number + 1
}
}
View(data)
str_split(variant, ",", simplify = TRUE)
str_split(data[["CE1_1.PL""]][1], ",", simplify = TRUE)
str_split(data[["CE1_1.PL"]][1], ",", simplify = TRUE)
str_split(data[["CE1_1.PL"]], ",", simplify = TRUE)
data[["CE1_1.PL"]]
data[[CE1_1.PL]]
data$Ce1_1.PL[1]
str_split(data$Ce1_1.PL[1], ",", simplify = TRUE)
dim(str_split(data$Ce1_1.PL[1], ",", simplify = TRUE))
dim(str_split(data$Ce1_1.PL[1], ",", simplify = TRUE))[2]
str_split(data$Ce1_1.PL[1], ",", simplify = TRUE)[2]
dim(data)
dim(data$TYPE)
count(data$TYPE)
length(data$TYPE)
length(data$TYPE == "SNP")
length(which(data$TYPE == "SNP"))
length(which(data$TYPE == "INDEL"))
length(which(data$CHROM == "Cepheus:6226575"))
length(which(data$CHROM == "Andromeda"))
unique(data$CHROM)
length(unique(data$CHROM))
knitr::opts_chunk$set(echo = TRUE)
summary(data)
dim(data)
